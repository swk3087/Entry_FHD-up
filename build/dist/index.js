(()=>{"use strict";const e=640,t={lastMode:"",lastPatchAt:0,lastObjectCount:0,lastVariableCount:0,lastResolution:0};self.__REQUEST_ANIMATION_FRAME_ID||(self.__REQUEST_ANIMATION_FRAME_ID=requestAnimationFrame((function s(){self.__REQUEST_ANIMATION_FRAME_ID=requestAnimationFrame(s);try{const s=function(){const e=document.querySelector("iframe.eaizycc0")?.contentWindow;return(e||self).Entry}(),n=s?.stage;if(!s||!n)return;const{useWebGL:o}=s.options,i=o?"webgl":"canvas",a=n.canvas.canvas,{width:r,height:l}=function(t){const s=Math.round(t.offsetWidth);if(s<=0)return{width:Math.max(e,t.width||e),height:Math.max(360,t.height||360)};const n=Math.max(e,Math.min(1920,Math.round(s*Math.max(1,devicePixelRatio)*1.5)));return{width:n,height:Math.round(9*n/16)}}(a),c=r/e,d=a.width!==r||a.height!==l;d&&function(e,t,s){const{canvas:n}=e,o=n.canvas;if(o.width===t&&o.height===s)return;o.width=t,o.height=s,n.x=t/2,n.y=s/2,n.scaleX=t/480,n.scaleY=s/270;const{_app:i}=e,{screen:a,renderer:r}=i;a&&r&&(a.width=t,a.height=s,r.resize(t,s),r.options.width=t,r.options.height=s),i.render?.(),n.update?.()}(n,r,l),o&&(d||t.lastResolution!==c)&&function(e,t){const s=[...e];for(;s.length>0;){const e=s.pop();e&&(e.resolution&&(e.resolution=t),s.push(...e.children))}}(n.canvas.children,c),t.lastResolution=c,function(e,t,s,n,o){const{canvas:i}=t,a=t.inputField;if(a&&!a._isHidden&&a._padding!==13*s/640){if(a.x(Math.round(3*s/128)),a.y(Math.round(55*n/72)),a.width(Math.max(1,13*s/16)),a.height(Math.max(1,n/15)),a.padding(13*s/640),a.borderWidth(s/320),a.borderRadius(s/64),a.fontSize(s/32),o){const e=a.getPixiView();e.scale.set(480/s,270/n),e.position.set((a._x-i.x)/i.scaleX,(a._y-i.y)/i.scaleY)}e.requestUpdate=!0,t.update(),e.requestUpdate=!1}}(s,n,r,l,o),function(e){const{canvas:t}=e;e.handle.getEventCoordinate=({stageX:e,stageY:s})=>({x:(e-t.x)/t.scaleX,y:(s-t.y)/t.scaleY})}(n);const v=performance.now(),h=s.container.objects_.length,u=n.variableContainer.children.length;(t.lastMode!==i||t.lastObjectCount!==h||t.lastVariableCount!==u||v-t.lastPatchAt>=300)&&(function(e,t,s){const n=()=>e.engine.isState("run");e.container.objects_.forEach((({entity:{object:n}})=>function(e,t,s,n){const o=`entity:${n}`;if(s._viewportPatchedMode===o)return;const{canvas:i}=t;s._viewportPatchedMode=o,s.removeAllListeners?.("__pointermove"),s.removeAllListeners?.("__pointerup"),s.removeAllEventListeners?.("mousedown"),s.removeAllEventListeners?.("pressmove"),s.on("webgl"===n?"__pointermove":"mousedown",(({stageX:n,stageY:o})=>{e.dispatchEvent("entityClick",s.entity),t.isObjectClick=!0,"minimize"!==e.type&&t.isEntitySelectable()&&(s.offset={x:-s.parent.x+s.entity.x-(n-i.x)/i.scaleX,y:-s.parent.y-s.entity.y-(o-i.y)/i.scaleY},s.cursor="move",s.entity.initCommand(),e.container.selectObject(s.entity.parent.id))})),s.on("webgl"===n?"__pointerup":"pressmove",(({stageX:e,stageY:n})=>{if(!t.isEntitySelectable())return;const{entity:o}=s;o.parent.getLock()||(o.setX((e-i.x)/i.scaleX+s.offset.x),o.setY((i.y-n)/i.scaleY-s.offset.y),t.updateObject())}))}(e,t,n,s))),t.variableContainer.children.forEach((o=>function(e,t,s,n,o){const{canvas:i}=e,{variable:a}=t,r=`variable:${s}`,l="webgl"===s?"__pointermove":"mousedown",c="webgl"===s?"__pointerup":"pressmove";if(a.slideBar_){const e=a.slideBar_,t=`slide:${s}`;e._viewportPatchedMode!==t&&(e._viewportPatchedMode=t,e.removeAllListeners?.("__pointermove"),e.removeAllEventListeners?.("mousedown"),e.on(l,(({stageX:e})=>o()&&a.setSlideCommandX(e/i.scaleX-a.getX()-i.x/i.scaleX))))}if(a.valueSetter_){const e=a.valueSetter_,t=`valueSetter:${s}`;e._viewportPatchedMode!==t&&(e._viewportPatchedMode=t,e.removeAllListeners?.("__pointermove"),e.removeAllListeners?.("__pointerup"),e.removeAllEventListeners?.("mousedown"),e.removeAllEventListeners?.("pressmove"),e.on(l,(({stageX:t})=>{o()&&(a.isAdjusting=!0,e.offsetX=t/i.scaleX-e.x)})),e.on(c,(({stageX:t})=>o()&&a.setSlideCommandX(t/i.scaleX-e.offsetX+5))))}if(a.resizeHandle_){const e=a.resizeHandle_,t=`resizeHandle:${s}`;e._viewportPatchedMode!==t&&(e._viewportPatchedMode=t,e.removeAllListeners?.("__pointermove"),e.removeAllListeners?.("__pointerup"),e.removeAllEventListeners?.("mousedown"),e.removeAllEventListeners?.("pressmove"),e.on(l,(({stageX:t,stageY:s})=>{a.isResizing=!0,e.offset={x:t/i.scaleX-a.getWidth(),y:s/i.scaleY-a.getHeight()},e.parent.cursor="nwse-resize"})),e.on(c,(({stageX:t,stageY:s})=>{a.setWidth(t/i.scaleX-e.offset.x),a.setHeight(s/i.scaleY-e.offset.y),a.updateView()})))}if(a.scrollButton_){const e=a.scrollButton_,t=`scrollButton:${s}`;e._viewportPatchedMode!==t&&(e._viewportPatchedMode=t,e.removeAllListeners?.("__pointermove"),e.removeAllListeners?.("__pointerup"),e.removeAllEventListeners?.("mousedown"),e.removeAllEventListeners?.("pressmove"),e.on(l,(({stageY:t})=>{a.isResizing=!0,e.offsetY=t-e.y*i.scaleY})),e.on(c,(({stageY:t})=>{const s=Math.max(25,Math.min(a.getHeight()-30,(t-e.offsetY)/i.scaleY));e.y=s,a.updateView()})))}t._viewportPatchedMode!==r&&(t._viewportPatchedMode=r,t.removeAllListeners?.("__pointermove"),t.removeAllListeners?.("__pointerup"),t.removeAllEventListeners?.("mousedown"),t.removeAllEventListeners?.("pressmove"),t.on(l,(({stageX:e,stageY:s})=>{"workspace"===n&&(t.offset={x:t.x-(e-i.x)/i.scaleX,y:t.y-(s-i.y)/i.scaleY})})),t.on(c,(({stageX:e,stageY:s})=>{"workspace"!==n||a.isResizing||a.isAdjusting||(a.setX((e-i.x)/i.scaleX+t.offset.x),a.setY((s-i.y)/i.scaleY+t.offset.y),a.updateView())})))}(t,o,s,e.type,n)))}(s,n,i),t.lastMode=i,t.lastPatchAt=v,t.lastObjectCount=h,t.lastVariableCount=u)}catch{}})))})();